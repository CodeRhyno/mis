<div class="row">
  <div class="col-md-8">
    <h1>User Details</h1>

    <div class="card mt-3">
      <div class="card-body">
        <h5 class="card-title"><%= @user.full_name %></h5>

        <table class="table">
          <tr>
            <th>Email:</th>
            <td><%= @user.email %></td>
          </tr>
          <tr>
            <th>Role:</th>
            <td><%= @user.role.titleize %></td>
          </tr>
          <tr>
            <th>Circle:</th>
            <td><%= @user.circle&.name || '-' %></td>
          </tr>
          <tr>
            <th>Branch:</th>
            <td><%= @user.branch&.name || '-' %></td>
          </tr>
          <tr>
            <th>Status:</th>
            <td>
              <% if @user.suspended %>
                <span class="badge bg-danger">Suspended</span>
              <% elsif @user.active %>
                <span class="badge bg-success">Active</span>
              <% else %>
                <span class="badge bg-secondary">Inactive</span>
              <% end %>
            </td>
          </tr>
          <tr>
            <th>Last Login:</th>
            <td><%= @user.last_login_at&.strftime('%B %d, %Y at %I:%M %p') || 'Never' %></td>
          </tr>
          <tr>
            <th>Created At:</th>
            <td><%= @user.created_at.strftime('%B %d, %Y') %></td>
          </tr>
        </table>

        <h6 class="mt-4">Permissions:</h6>
        <ul>
          <% @user.permissions.each do |permission| %>
            <li><%= permission.title %></li>
          <% end %>
        </ul>
      </div>
    </div>

    <div class="mt-3">
      <%= link_to 'Edit User', edit_user_path(@user), class: 'btn btn-primary' %>

      <% if @user.suspended %>
        <%= button_to 'Activate User', activate_user_path(@user), method: :patch, class: 'btn btn-success', data: { confirm: 'Are you sure you want to activate this user?' } %>
      <% else %>
        <%= button_to 'Suspend User', suspend_user_path(@user), method: :patch, class: 'btn btn-warning', data: { confirm: 'Are you sure you want to suspend this user?' } %>
      <% end %>

      <%= button_to 'Delete User', user_path(@user), method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure you want to delete this user? This action cannot be undone.' } %>

      <%= link_to 'Back to Users', users_path, class: 'btn btn-secondary' %>
    </div>
  </div>
</div>
