<div class="row justify-content-center">
  <div class="col-md-8">
    <h1>Verification Result</h1>

    <% if @verification_result[:status] == 'success' %>
      <div class="alert alert-success" role="alert">
        <h4 class="alert-heading"><i class="bi bi-check-circle-fill"></i> Success!</h4>
        <p><%= @verification_result[:message] %></p>
        <hr>
        <p class="mb-0"><strong>SHA-256 Hash:</strong> <code><%= @verification_result[:hash] %></code></p>
      </div>

      <div class="card mt-4">
        <div class="card-header">
          <h5 class="mb-0">Document Details</h5>
        </div>
        <div class="card-body">
          <table class="table table-bordered">
            <tr>
              <th style="width: 30%;">Filename:</th>
              <td><%= @verification_result[:document].filename %></td>
            </tr>
            <tr>
              <th>Record:</th>
              <td><%= link_to @verification_result[:document].record.title, record_path(@verification_result[:document].record) %></td>
            </tr>
            <tr>
              <th>Uploaded By:</th>
              <td><%= @verification_result[:document].uploaded_by.full_name %></td>
            </tr>
            <tr>
              <th>Upload Date:</th>
              <td><%= @verification_result[:document].created_at.strftime('%B %d, %Y at %I:%M %p') %></td>
            </tr>
            <tr>
              <th>File Size:</th>
              <td><%= number_to_human_size(@verification_result[:document].file_size) %></td>
            </tr>
            <tr>
              <th>SHA-256 Hash:</th>
              <td><code class="small"><%= @verification_result[:document].sha256_hash %></code></td>
            </tr>
            <tr>
              <th>Circle:</th>
              <td><%= @verification_result[:document].record.circle&.name || '-' %></td>
            </tr>
            <tr>
              <th>Branch:</th>
              <td><%= @verification_result[:document].record.branch&.name || '-' %></td>
            </tr>
            <tr>
              <th>Verification Status:</th>
              <td>
                <% if @verification_result[:document].record.verified %>
                  <span class="badge bg-success">Verified by <%= @verification_result[:document].record.verified_by&.full_name %></span>
                <% elsif @verification_result[:document].record.objected %>
                  <span class="badge bg-danger">Objected</span>
                <% else %>
                  <span class="badge bg-warning">Pending Verification</span>
                <% end %>
              </td>
            </tr>
          </table>

          <div class="mt-3">
            <%= link_to 'Download Original', download_document_path(@verification_result[:document]), class: 'btn btn-primary' %>
            <%= link_to 'View Record', record_path(@verification_result[:document].record), class: 'btn btn-secondary' %>
          </div>
        </div>
      </div>
    <% else %>
      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading"><i class="bi bi-x-circle-fill"></i> Verification Failed</h4>
        <p><%= @verification_result[:message] %></p>
        <hr>
        <p class="mb-0"><strong>Calculated SHA-256 Hash:</strong> <code><%= @verification_result[:hash] %></code></p>
      </div>

      <div class="card mt-4">
        <div class="card-body">
          <h5 class="card-title">Possible Reasons</h5>
          <ul>
            <li>The document has never been uploaded to the system</li>
            <li>The document has been modified after upload (even minor changes will alter the hash)</li>
            <li>The file format was converted or re-saved</li>
            <li>The document metadata was changed</li>
          </ul>

          <div class="alert alert-info mt-3">
            <strong>Tip:</strong> Make sure you're verifying the exact same file that was originally uploaded, without any modifications.
          </div>
        </div>
      </div>
    <% end %>

    <div class="mt-4">
      <%= link_to 'Verify Another Document', verify_documents_path, class: 'btn btn-primary' %>
      <%= link_to 'Back to Records', records_path, class: 'btn btn-secondary' %>
    </div>
  </div>
</div>
